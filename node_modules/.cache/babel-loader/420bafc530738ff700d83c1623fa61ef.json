{"ast":null,"code":"import _regeneratorRuntime from\"D:/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"D:/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"D:/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";export var ApiService=/*#__PURE__*/function(){function ApiService(axios){_classCallCheck(this,ApiService);this._axios=axios;this._axios.interceptors.request.use(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(cfg){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=sessionStorage.getItem(\"token\");if(token){cfg.headers[\"Authorization\"]=\"Bearer \"+token;}return _context.abrupt(\"return\",_objectSpread(_objectSpread({},cfg),{},{withCredentials:true,headers:_objectSpread({\"Accept\":\"*/*\"},cfg.headers)}));case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}_createClass(ApiService,[{key:\"getToken\",value:function(){var _getToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(username,password){var resp;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this._axios.post(\"/api/login/getToken\",{username:username,password:password},{validateStatus:function validateStatus(status){return status===200||status===400;}});case 2:resp=_context2.sent;sessionStorage.setItem(\"token\",resp.data);case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function getToken(_x2,_x3){return _getToken.apply(this,arguments);}return getToken;}()},{key:\"getPrize\",value:function(){var _getPrize=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(hccid){var resp;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this._axios.get(\"/api/prize/getPrize/\".concat(hccid),{validateStatus:function validateStatus(status){return status===200||status===400;}});case 2:resp=_context3.sent;return _context3.abrupt(\"return\",resp.data);case 4:case\"end\":return _context3.stop();}}},_callee3,this);}));function getPrize(_x4){return _getPrize.apply(this,arguments);}return getPrize;}()},{key:\"postUser\",value:function(){var _postUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(hccid,fullname){var resp;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this._axios.post(\"/api/users/register/\",{\"hccId\":parseInt(hccid),\"fullname\":fullname},{validateStatus:function validateStatus(status){return status===200||status===400;}});case 2:resp=_context4.sent;return _context4.abrupt(\"return\",resp.data);case 4:case\"end\":return _context4.stop();}}},_callee4,this);}));function postUser(_x5,_x6){return _postUser.apply(this,arguments);}return postUser;}()},{key:\"getRankList\",value:function(){var _getRankList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var resp;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this._axios.get(\"/api/prize/getAllRank/\",{validateStatus:function validateStatus(status){return status===200||status===400;}});case 2:resp=_context5.sent;return _context5.abrupt(\"return\",resp.data);case 4:case\"end\":return _context5.stop();}}},_callee5,this);}));function getRankList(){return _getRankList.apply(this,arguments);}return getRankList;}()}]);return ApiService;}();","map":{"version":3,"sources":["D:/react/src/services/api/apiService.js"],"names":["ApiService","axios","_axios","interceptors","request","use","cfg","token","sessionStorage","getItem","headers","withCredentials","username","password","post","validateStatus","status","resp","setItem","data","hccid","get","fullname","parseInt"],"mappings":"qnBAAA,UAAaA,CAAAA,UAAb,yBACE,oBAAYC,KAAZ,CAAmB,kCACjB,KAAKC,MAAL,CAAcD,KAAd,CACA,KAAKC,MAAL,CAAYC,YAAZ,CAAyBC,OAAzB,CAAiCC,GAAjC,0FAAqC,iBAAOC,GAAP,4HAC7BC,KAD6B,CACrBC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CADqB,CAEnC,GAAIF,KAAJ,CAAW,CACTD,GAAG,CAACI,OAAJ,CAAY,eAAZ,EAA+B,UAAYH,KAA3C,CACD,CAJkC,+DAM9BD,GAN8B,MAOjCK,eAAe,CAAE,IAPgB,CAQjCD,OAAO,gBACH,SAAS,KADN,EAGFJ,GAAG,CAACI,OAHF,CAR0B,0DAArC,gEAeD,CAlBH,gIAoBE,kBAAeE,QAAf,CAAyBC,QAAzB,sJACqB,MAAKX,MAAL,CAAYY,IAAZ,CACjB,qBADiB,CAEjB,CACEF,QAAQ,CAAEA,QADZ,CAEEC,QAAQ,CAAEA,QAFZ,CAFiB,CAMjB,CACEE,cAAc,CAAE,wBAACC,MAAD,QAAYA,CAAAA,MAAM,GAAK,GAAX,EAAkBA,MAAM,GAAK,GAAzC,EADlB,CANiB,CADrB,QACQC,IADR,gBAWET,cAAc,CAACU,OAAf,CAAuB,OAAvB,CAAgCD,IAAI,CAACE,IAArC,EAXF,6DApBF,kMAiCE,kBAAeC,KAAf,sJACqB,MAAKlB,MAAL,CAAYmB,GAAZ,+BACMD,KADN,EAEhB,CACCL,cAAc,CAAE,wBAACC,MAAD,QAAYA,CAAAA,MAAM,GAAK,GAAX,EAAkBA,MAAM,GAAK,GAAzC,EADjB,CAFgB,CADrB,QACQC,IADR,iDAOSA,IAAI,CAACE,IAPd,+DAjCF,8LA0CE,kBAAeC,KAAf,CAAqBE,QAArB,sJACqB,MAAKpB,MAAL,CAAYY,IAAZ,wBAEjB,CACE,QAAQS,QAAQ,CAACH,KAAD,CADlB,CAEE,WAAWE,QAFb,CAFiB,CAOhB,CACCP,cAAc,CAAE,wBAACC,MAAD,QAAYA,CAAAA,MAAM,GAAK,GAAX,EAAkBA,MAAM,GAAK,GAAzC,EADjB,CAPgB,CADrB,QACQC,IADR,iDAYSA,IAAI,CAACE,IAZd,+DA1CF,wMAwDE,wKACqB,MAAKjB,MAAL,CAAYmB,GAAZ,0BAEhB,CACCN,cAAc,CAAE,wBAACC,MAAD,QAAYA,CAAAA,MAAM,GAAK,GAAX,EAAkBA,MAAM,GAAK,GAAzC,EADjB,CAFgB,CADrB,QACQC,IADR,iDAOSA,IAAI,CAACE,IAPd,+DAxDF","sourcesContent":["export class ApiService {\r\n  constructor(axios) {\r\n    this._axios = axios;\r\n    this._axios.interceptors.request.use(async (cfg) => {\r\n      const token = sessionStorage.getItem(\"token\");\r\n      if (token) {\r\n        cfg.headers[\"Authorization\"] = \"Bearer \" + token;\r\n      }\r\n      return {\r\n        ...cfg,\r\n        withCredentials: true,\r\n        headers: {\r\n            \"Accept\":\"*/*\",\r\n        //   \"X-Accept-Cookie\": true,\r\n          ...cfg.headers,\r\n        },\r\n      };\r\n    });\r\n  }\r\n\r\n  async getToken(username, password) {\r\n    const resp = await this._axios.post(\r\n      \"/api/login/getToken\",\r\n      {\r\n        username: username,\r\n        password: password,\r\n      },\r\n      {\r\n        validateStatus: (status) => status === 200 || status === 400,\r\n      }\r\n    );    \r\n    sessionStorage.setItem(\"token\", resp.data)\r\n  }\r\n  async getPrize(hccid) {\r\n    const resp = await this._axios.get(\r\n      `/api/prize/getPrize/${hccid}`,\r\n       {\r\n        validateStatus: (status) => status === 200 || status === 400,\r\n      }\r\n    );    \r\n    return resp.data\r\n  }\r\n  async postUser(hccid,fullname) {\r\n    const resp = await this._axios.post(\r\n      `/api/users/register/`,\r\n      {\r\n        \"hccId\":parseInt(hccid),\r\n        \"fullname\":fullname    \r\n      }\r\n      ,\r\n       {\r\n        validateStatus: (status) => status === 200 || status === 400,\r\n      }\r\n    );    \r\n    return resp.data\r\n  }\r\n  async getRankList() {\r\n    const resp = await this._axios.get(\r\n      `/api/prize/getAllRank/`,\r\n       {\r\n        validateStatus: (status) => status === 200 || status === 400,\r\n      }\r\n    );    \r\n    return resp.data\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}